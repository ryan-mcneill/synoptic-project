{"ast":null,"code":"import FastAverageColor from \"fast-average-color\";\nimport { SET_BACKGROUND, SHUFFLE_SONGS, TOGGLE_PLAYING } from \"../types\";\nimport { updatePlaylist } from \"./playlistActions\";\nimport shuffle from \"lodash.shuffle\";\nexport const setBackground = data => ({\n  type: SET_BACKGROUND,\n  data\n});\nexport const togglePlaying = isPlaying => ({\n  type: TOGGLE_PLAYING,\n  isPlaying\n});\n\nconst shuffleSongsAction = () => ({\n  type: SHUFFLE_SONGS\n});\n\nexport const nextSong = () => {\n  return (dispatch, getState) => {\n    const {\n      playlist\n    } = getState();\n\n    if (playlist && playlist.current && playlist.next.length > 0) {\n      const previous = playlist.previous ? playlist.previous.concat(playlist.current) : [playlist.current];\n      const current = playlist.next[0];\n      const next = playlist.next.length > 1 ? playlist.next.slice(1, playlist.next.length) : [];\n      dispatch(updatePlaylist({\n        previous,\n        current,\n        next\n      }));\n    }\n  };\n};\nexport const prevSong = () => {\n  return (dispatch, getState) => {\n    const {\n      playlist\n    } = getState();\n\n    if (playlist && playlist.current && playlist.previous.length > 0) {\n      const previous = playlist.previous.length > 1 ? playlist.previous.slice(0, playlist.previous.length - 1) : [];\n      const current = playlist.previous[playlist.previous.length - 1];\n      const next = [playlist.current, ...playlist.next];\n      dispatch(updatePlaylist({\n        previous,\n        current,\n        next\n      }));\n    }\n  };\n};\nexport const getBackground = ({\n  id\n}) => {\n  return dispatch => {\n    const fac = new FastAverageColor();\n    fac.getColorAsync(`/api/album/art/${id}`).then(color => {\n      const {\n        isLight,\n        isDark,\n        hex: colour\n      } = color;\n      dispatch(setBackground({\n        isLight,\n        isDark,\n        colour\n      }));\n    }).catch(error => {\n      console.error(error.message);\n    });\n  };\n};\nexport const shuffleSongs = () => {\n  return (dispatch, getState) => {\n    const {\n      playlist\n    } = getState();\n    const previous = playlist.previous;\n    const current = playlist.current;\n    const next = shuffle(playlist.next);\n    dispatch(shuffleSongsAction());\n    dispatch(updatePlaylist({\n      previous,\n      current,\n      next\n    }));\n  };\n};","map":{"version":3,"sources":["/Users/mcneillr/personal/synoptic-project/packages/app/src/store/actions/currentSongActions.ts"],"names":["FastAverageColor","SET_BACKGROUND","SHUFFLE_SONGS","TOGGLE_PLAYING","updatePlaylist","shuffle","setBackground","data","type","togglePlaying","isPlaying","shuffleSongsAction","nextSong","dispatch","getState","playlist","current","next","length","previous","concat","slice","prevSong","getBackground","id","fac","getColorAsync","then","color","isLight","isDark","hex","colour","catch","error","console","message","shuffleSongs"],"mappings":"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","sourcesContent":["import { Action, Dispatch } from \"redux\";\nimport FastAverageColor from \"fast-average-color\";\nimport {\n  Background,\n  CurrentSongActions,\n  SET_BACKGROUND,\n  SHUFFLE_SONGS,\n  ShuffleSongsAction,\n  State,\n  TOGGLE_PLAYING\n} from \"../types\";\nimport { ThunkDispatch } from \"redux-thunk\";\nimport { playlistRemove, updatePlaylist } from \"./playlistActions\";\nimport shuffle from \"lodash.shuffle\";\n\nexport const setBackground = (data: Background): CurrentSongActions => ({\n  type: SET_BACKGROUND,\n  data\n});\n\nexport const togglePlaying = (isPlaying?: boolean): CurrentSongActions => ({\n  type: TOGGLE_PLAYING,\n  isPlaying\n});\n\nconst shuffleSongsAction = (): ShuffleSongsAction => ({\n  type: SHUFFLE_SONGS\n});\n\nexport const nextSong = () => {\n  return (\n    dispatch: ThunkDispatch<State, void, Action>,\n    getState: () => State\n  ) => {\n    const { playlist } = getState();\n\n    if (playlist && playlist.current && playlist.next.length > 0) {\n      const previous = playlist.previous\n        ? playlist.previous.concat(playlist.current)\n        : [playlist.current];\n      const current = playlist.next[0];\n      const next =\n        playlist.next.length > 1\n          ? playlist.next.slice(1, playlist.next.length)\n          : [];\n\n      dispatch(updatePlaylist({ previous, current, next }));\n    }\n  };\n};\n\nexport const prevSong = () => {\n  return (\n    dispatch: ThunkDispatch<State, void, Action>,\n    getState: () => State\n  ) => {\n    const { playlist } = getState();\n\n    if (playlist && playlist.current && playlist.previous.length > 0) {\n      const previous =\n        playlist.previous.length > 1\n          ? playlist.previous.slice(0, playlist.previous.length - 1)\n          : [];\n      const current = playlist.previous[playlist.previous.length - 1];\n      const next = [playlist.current, ...playlist.next];\n\n      dispatch(updatePlaylist({ previous, current, next }));\n    }\n  };\n};\n\nexport const getBackground = ({ id }: { id: string }) => {\n  return (dispatch: Dispatch) => {\n    const fac = new FastAverageColor();\n\n    fac\n      .getColorAsync(`/api/album/art/${id}`)\n      .then((color: IFastAverageColorResult) => {\n        const { isLight, isDark, hex: colour } = color;\n        dispatch(setBackground({ isLight, isDark, colour }));\n      })\n      .catch((error: Error) => {\n        console.error(error.message);\n      });\n  };\n};\n\nexport const shuffleSongs = () => {\n  return (\n    dispatch: ThunkDispatch<State, void, Action>,\n    getState: () => State\n  ) => {\n    const { playlist } = getState();\n    const previous = playlist.previous;\n    const current = playlist.current;\n    const next = shuffle(playlist.next);\n\n    dispatch(shuffleSongsAction());\n    dispatch(updatePlaylist({ previous, current, next }));\n  };\n};\n"]},"metadata":{},"sourceType":"module"}